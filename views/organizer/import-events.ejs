<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Import Events</h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <div class="d-flex">
                            <div class="me-3">
                                <i class="fas fa-info-circle fa-2x"></i>
                            </div>
                            <div>
                                <h5>Import Events from External Sources</h5>
                                <p class="mb-0">You can import events from CSV files, external calendars, or by connecting to third-party event platforms. Review the imported data before finalizing.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Import Options -->
                    <div class="row mt-4">
                        <div class="col-md-4 mb-4">
                            <div class="card h-100">
                                <div class="card-body text-center py-4">
                                    <i class="fas fa-file-csv fa-3x text-primary mb-3"></i>
                                    <h5>CSV Import</h5>
                                    <p class="text-muted">Import events from a CSV file</p>
                                    <button class="btn btn-primary" data-bs-toggle="collapse" data-bs-target="#csvImportForm">
                                        Select File
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="card h-100">
                                <div class="card-body text-center py-4">
                                    <i class="fas fa-calendar-alt fa-3x text-success mb-3"></i>
                                    <h5>Calendar Import</h5>
                                    <p class="text-muted">Import from iCal, Google Calendar</p>
                                    <button class="btn btn-success" data-bs-toggle="collapse" data-bs-target="#calendarImportForm">
                                        Connect Calendar
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="card h-100">
                                <div class="card-body text-center py-4">
                                    <i class="fas fa-plug fa-3x text-info mb-3"></i>
                                    <h5>Platform Import</h5>
                                    <p class="text-muted">Import from other event platforms</p>
                                    <button class="btn btn-info" data-bs-toggle="collapse" data-bs-target="#platformImportForm">
                                        Connect Platform
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- CSV Import Form -->
                    <div class="collapse mt-4 mb-5" id="csvImportForm">
                        <div class="card border">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">CSV Import</h6>
                            </div>
                            <div class="card-body">
                                <form action="/organizer/import-events/csv" method="POST" enctype="multipart/form-data">
                                    <div class="mb-3">
                                        <label for="csvFile" class="form-label">Select CSV File</label>
                                        <input type="file" class="form-control" id="csvFile" name="csvFile" accept=".csv" required>
                                        <div class="form-text">
                                            File must be in CSV format with the required columns.
                                            <a href="#" data-bs-toggle="modal" data-bs-target="#csvTemplateModal">Download template</a>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="headerRow" name="headerRow" checked>
                                            <label class="form-check-label" for="headerRow">File contains header row</label>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label class="form-label">Column Mapping</label>
                                        <div class="table-responsive">
                                            <table class="table table-bordered">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th>System Field</th>
                                                        <th>CSV Column</th>
                                                        <th>Required</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>Event Name</td>
                                                        <td>
                                                            <select class="form-select form-select-sm" name="mapping_name">
                                                                <option value="name">Name</option>
                                                                <option value="event_name">Event Name</option>
                                                                <option value="title">Title</option>
                                                            </select>
                                                        </td>
                                                        <td><span class="badge bg-danger">Required</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Start Date</td>
                                                        <td>
                                                            <select class="form-select form-select-sm" name="mapping_date">
                                                                <option value="date">Date</option>
                                                                <option value="start_date">Start Date</option>
                                                                <option value="event_date">Event Date</option>
                                                            </select>
                                                        </td>
                                                        <td><span class="badge bg-danger">Required</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Location</td>
                                                        <td>
                                                            <select class="form-select form-select-sm" name="mapping_location">
                                                                <option value="location">Location</option>
                                                                <option value="venue">Venue</option>
                                                                <option value="place">Place</option>
                                                            </select>
                                                        </td>
                                                        <td><span class="badge bg-danger">Required</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Sport</td>
                                                        <td>
                                                            <select class="form-select form-select-sm" name="mapping_sport">
                                                                <option value="sport">Sport</option>
                                                                <option value="sport_type">Sport Type</option>
                                                                <option value="category">Category</option>
                                                            </select>
                                                        </td>
                                                        <td><span class="badge bg-danger">Required</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Description</td>
                                                        <td>
                                                            <select class="form-select form-select-sm" name="mapping_description">
                                                                <option value="description">Description</option>
                                                                <option value="details">Details</option>
                                                                <option value="info">Info</option>
                                                            </select>
                                                        </td>
                                                        <td><span class="badge bg-secondary">Optional</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Max Teams</td>
                                                        <td>
                                                            <select class="form-select form-select-sm" name="mapping_teams">
                                                                <option value="max_teams">Max Teams</option>
                                                                <option value="capacity">Capacity</option>
                                                                <option value="slots">Slots</option>
                                                            </select>
                                                        </td>
                                                        <td><span class="badge bg-secondary">Optional</span></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    
                                    <div class="d-flex justify-content-end">
                                        <button type="button" class="btn btn-secondary me-2" data-bs-toggle="collapse" data-bs-target="#csvImportForm">
                                            Cancel
                                        </button>
                                        <button type="submit" class="btn btn-primary">
                                            Upload & Preview
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Calendar Import Form -->
                    <div class="collapse mt-4 mb-5" id="calendarImportForm">
                        <div class="card border">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">Calendar Import</h6>
                            </div>
                            <div class="card-body">
                                <form action="/organizer/import-events/calendar" method="POST">
                                    <div class="mb-4">
                                        <label class="form-label">Select Calendar Service</label>
                                        <div class="d-flex flex-wrap gap-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="calendarService" id="googleCalendar" value="google" checked>
                                                <label class="form-check-label" for="googleCalendar">
                                                    <i class="fab fa-google text-danger me-1"></i> Google Calendar
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="calendarService" id="outlookCalendar" value="outlook">
                                                <label class="form-check-label" for="outlookCalendar">
                                                    <i class="fab fa-microsoft text-primary me-1"></i> Outlook Calendar
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="calendarService" id="appleCalendar" value="apple">
                                                <label class="form-check-label" for="appleCalendar">
                                                    <i class="fab fa-apple text-dark me-1"></i> Apple Calendar
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="calendarService" id="iCalFile" value="ical">
                                                <label class="form-check-label" for="iCalFile">
                                                    <i class="fas fa-calendar-alt text-success me-1"></i> iCal File
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div id="icalUpload" class="mb-3 d-none">
                                        <label for="icalFile" class="form-label">Upload iCal File</label>
                                        <input type="file" class="form-control" id="icalFile" name="icalFile" accept=".ics">
                                    </div>
                                    
                                    <div id="oauthConnect" class="mb-3">
                                        <p>You'll need to authorize access to your calendar. We'll only import the events you select.</p>
                                        <button type="button" id="connectCalendarBtn" class="btn btn-outline-primary">
                                            <i class="fas fa-link me-1"></i> Connect to Calendar
                                        </button>
                                    </div>
                                    
                                    <div class="mb-3 d-none" id="dateRangeSelector">
                                        <label class="form-label">Date Range to Import</label>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <label for="importStartDate" class="form-label">From</label>
                                                <input type="date" class="form-control" id="importStartDate" name="importStartDate">
                                            </div>
                                            <div class="col-md-6">
                                                <label for="importEndDate" class="form-label">To</label>
                                                <input type="date" class="form-control" id="importEndDate" name="importEndDate">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="d-flex justify-content-end">
                                        <button type="button" class="btn btn-secondary me-2" data-bs-toggle="collapse" data-bs-target="#calendarImportForm">
                                            Cancel
                                        </button>
                                        <button type="submit" class="btn btn-success" disabled id="importCalendarBtn">
                                            Import Events
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Platform Import Form -->
                    <div class="collapse mt-4 mb-5" id="platformImportForm">
                        <div class="card border">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">Platform Import</h6>
                            </div>
                            <div class="card-body">
                                <form action="/organizer/import-events/platform" method="POST">
                                    <div class="mb-4">
                                        <label class="form-label">Select Platform</label>
                                        <div class="d-flex flex-wrap gap-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="platformService" id="platform1" value="eventbrite" checked>
                                                <label class="form-check-label" for="platform1">
                                                    <i class="fas fa-ticket-alt text-warning me-1"></i> Eventbrite
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="platformService" id="platform2" value="meetup">
                                                <label class="form-check-label" for="platform2">
                                                    <i class="fab fa-meetup text-danger me-1"></i> Meetup
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="platformService" id="platform3" value="facebook">
                                                <label class="form-check-label" for="platform3">
                                                    <i class="fab fa-facebook text-primary me-1"></i> Facebook Events
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <p>Connect your account to import events. We'll only import the events you select.</p>
                                        <button type="button" id="connectPlatformBtn" class="btn btn-outline-info">
                                            <i class="fas fa-link me-1"></i> Connect Account
                                        </button>
                                    </div>
                                    
                                    <div class="d-flex justify-content-end">
                                        <button type="button" class="btn btn-secondary me-2" data-bs-toggle="collapse" data-bs-target="#platformImportForm">
                                            Cancel
                                        </button>
                                        <button type="submit" class="btn btn-info" disabled id="importPlatformBtn">
                                            Import Events
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Import History -->
                    <div class="mt-4">
                        <h5>Import History</h5>
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>Import Date</th>
                                        <th>Source</th>
                                        <th>Events</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="5" class="text-center py-3 text-muted">No import history available</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- CSV Template Modal -->
<div class="modal fade" id="csvTemplateModal" tabindex="-1" aria-labelledby="csvTemplateModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="csvTemplateModalLabel">CSV Template</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Download our CSV template with the required columns for importing events.</p>
                <div class="alert alert-light border">
                    <strong>Required columns:</strong>
                    <ul class="mb-0">
                        <li>name (Event Name)</li>
                        <li>start_date (Format: YYYY-MM-DD)</li>
                        <li>location (Venue)</li>
                        <li>sport (Sport Type)</li>
                    </ul>
                </div>
                <div class="alert alert-light border">
                    <strong>Optional columns:</strong>
                    <ul class="mb-0">
                        <li>description (Event Description)</li>
                        <li>end_date (Format: YYYY-MM-DD)</li>
                        <li>max_teams (Maximum Team Slots)</li>
                        <li>contact_email (Contact Email)</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <a href="/downloads/event_import_template.csv" class="btn btn-primary">
                    <i class="fas fa-download me-1"></i> Download Template
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Handle iCal file upload option
        const iCalRadio = document.getElementById('iCalFile');
        const icalUpload = document.getElementById('icalUpload');
        const oauthConnect = document.getElementById('oauthConnect');
        const importCalendarBtn = document.getElementById('importCalendarBtn');
        const dateRangeSelector = document.getElementById('dateRangeSelector');
        
        const calendarRadios = document.querySelectorAll('input[name="calendarService"]');
        calendarRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                if (this.value === 'ical') {
                    icalUpload.classList.remove('d-none');
                    oauthConnect.classList.add('d-none');
                    dateRangeSelector.classList.remove('d-none');
                    importCalendarBtn.disabled = false;
                } else {
                    icalUpload.classList.add('d-none');
                    oauthConnect.classList.remove('d-none');
                    dateRangeSelector.classList.add('d-none');
                    importCalendarBtn.disabled = true;
                }
            });
        });
        
        // Connect Calendar Button
        const connectCalendarBtn = document.getElementById('connectCalendarBtn');
        if (connectCalendarBtn) {
            connectCalendarBtn.addEventListener('click', function() {
                // This would typically trigger an OAuth flow
                alert('This would connect to your calendar service (OAuth flow). Feature is currently in development.');
                dateRangeSelector.classList.remove('d-none');
                importCalendarBtn.disabled = false;
            });
        }
        
        // Connect Platform Button
        const connectPlatformBtn = document.getElementById('connectPlatformBtn');
        const importPlatformBtn = document.getElementById('importPlatformBtn');
        if (connectPlatformBtn) {
            connectPlatformBtn.addEventListener('click', function() {
                // This would typically trigger an OAuth flow
                alert('This would connect to your event platform (OAuth flow). Feature is currently in development.');
                importPlatformBtn.disabled = false;
            });
        }
    });
</script> 