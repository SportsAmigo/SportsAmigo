<!-- Player Team Details Page -->
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h2 class="mb-0"><%= team.name %></h2>
                            <p class="lead mt-2 mb-0">
                                <span class="badge bg-light text-dark"><%= team.sport %></span>
                            </p>
                        </div>
                        <div>
                            <a href="/player/my-teams" class="btn btn-light">
                                <i class="fas fa-arrow-left me-2"></i> Back to My Teams
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Request Status (if applicable) -->
    <% if (requestStatus) { %>
        <div class="row mb-4">
            <div class="col-12">
                <div class="alert alert-<%= requestStatus === 'pending' ? 'warning' : (requestStatus === 'approved' ? 'success' : 'danger') %>" role="alert">
                    <% if (requestStatus === 'pending') { %>
                        <i class="fas fa-clock me-2"></i> Your request to join this team is pending.
                    <% } else if (requestStatus === 'approved') { %>
                        <i class="fas fa-check-circle me-2"></i> Your request to join this team has been approved.
                    <% } else if (requestStatus === 'rejected') { %>
                        <i class="fas fa-times-circle me-2"></i> Your request to join this team was rejected.
                    <% } %>
                </div>
            </div>
        </div>
    <% } %>

    <div class="row">
        <!-- Team Information -->
        <div class="col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i> Team Information</h5>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <strong>Manager:</strong> <%= team.manager_first_name %> <%= team.manager_last_name %>
                            <a href="mailto:<%= team.manager_email %>" class="ms-2"><i class="fas fa-envelope"></i></a>
                        </li>
                        <li class="list-group-item">
                            <strong>Members:</strong> <%= team.current_members || 0 %> of <%= team.max_members || 0 %>
                        </li>
                        <% if (team.created_at) { %>
                            <li class="list-group-item">
                                <strong>Created:</strong> <%= new Date(team.created_at).toLocaleDateString() %>
                            </li>
                        <% } %>
                        <li class="list-group-item">
                            <% 
                                // Calculate percentage for progress bar
                                var percentage = Math.min(100, ((team.current_members || 0) / (team.max_members || 1)) * 100);
                            %>
                            <strong>Team Capacity:</strong>
                            <div class="progress mt-2" style="height: 20px;">
                    <div class="progress-bar bg-primary" role="progressbar" 
                        data-width="<%= percentage %>"
                        aria-valuenow="<%= team.current_members || 0 %>" 
                                    aria-valuemin="0" 
                                    aria-valuemax="<%= team.max_members || 0 %>">
                                    <%= Math.round(percentage) %>%
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <% if (isTeamMember) { %>
                    <div class="card-footer">
                        <button class="btn btn-outline-danger w-100" 
                                data-team-action="leave" 
                                data-team-id="<%= team.id %>">
                            <i class="fas fa-sign-out-alt me-2"></i> Leave Team
                        </button>
                    </div>
                <% } else if (!requestStatus) { %>
                    <div class="card-footer">
                        <button class="btn btn-success w-100" 
                                data-team-action="join" 
                                data-team-id="<%= team.id %>">
                            <i class="fas fa-user-plus me-2"></i> Request to Join
                        </button>
                    </div>
                <% } %>
            </div>
        </div>

        <!-- Team Description -->
        <div class="col-md-8 mb-4">
            <div class="card h-100">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="fas fa-align-left me-2"></i> About the Team</h5>
                </div>
                <div class="card-body">
                    <% if (team.description) { %>
                        <p><%= team.description %></p>
                    <% } else { %>
                        <p class="text-muted">No description available for this team.</p>
                    <% } %>
                </div>
            </div>
        </div>
    </div>

    <!-- Team Members Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="fas fa-users me-2"></i> Team Members</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Name</th>
                                    <th scope="col">Email</th>
                                    <th scope="col">Join Date</th>
                                    <th scope="col">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% if (team.members_list && team.members_list.length > 0) { %>
                                    <% team.members_list.forEach((member, index) => { %>
                                        <tr>
                                            <td><%= index + 1 %></td>
                                            <td>
                                                <%= member.first_name %> <%= member.last_name %>
                                                <% if (profile && profile.id === member.player_id) { %>
                                                    <span class="badge bg-success">You</span>
                                                <% } %>
                                            </td>
                                            <td><%= member.email %></td>
                                            <td><%= new Date(member.join_date).toLocaleDateString() %></td>
                                            <td>
                                                <span class="badge bg-<%= member.status === 'active' ? 'success' : 'secondary' %>">
                                                    <%= member.status %>
                                                </span>
                                            </td>
                                        </tr>
                                    <% }); %>
                                <% } else { %>
                                    <tr>
                                        <td colspan="5" class="text-center">No team members information available</td>
                                    </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Custom JavaScript can be added here if needed
    });
</script> 